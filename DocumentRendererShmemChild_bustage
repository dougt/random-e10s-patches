diff --git a/content/canvas/src/DocumentRendererShmemChild.cpp b/content/canvas/src/DocumentRendererShmemChild.cpp
--- a/content/canvas/src/DocumentRendererShmemChild.cpp
+++ b/content/canvas/src/DocumentRendererShmemChild.cpp
@@ -42,17 +42,17 @@
 #include "nsIDOMWindow.h"
 #include "nsIDOMDocument.h"
 #include "nsIDocShell.h"
 #include "nsIDocShellTreeNode.h"
 #include "nsIDocShellTreeItem.h"
 #include "nsIDocument.h"
 #include "nsIInterfaceRequestorUtils.h"
 #include "nsComponentManagerUtils.h"
-#include "nsICSSParser.h"
+#include "nsCSSParser.h"
 #include "nsPresContext.h"
 #include "nsCOMPtr.h"
 #include "nsColor.h"
 #include "gfxContext.h"
 #include "gfxImageSurface.h"
 #include "nsLayoutUtils.h"
 
 #include "mozilla/ipc/DocumentRendererShmemChild.h"
@@ -118,33 +118,29 @@ DocumentRendererShmemChild::RenderDocume
         if (docshell) {
             docshell->GetPresContext(getter_AddRefs(presContext));
         }
     }
     if (!presContext)
         return false;
 
     nscolor bgColor;
-    nsCOMPtr<nsICSSParser> parser = do_CreateInstance("@mozilla.org/content/css-parser;1");
-    nsresult rv = parser->ParseColorString(PromiseFlatString(aBGColor),
-                                           nsnull, 0, &bgColor);
+    nsCSSParser parser;
+    nsresult rv = parser.ParseColorString(PromiseFlatString(aBGColor),
+					  nsnull, 0, &bgColor);
     if (NS_FAILED(rv))
         return false;
 
     nsIPresShell* presShell = presContext->PresShell();
 
     nsRect r(x, y, w, h);
 
     // Draw directly into the output array.
     nsRefPtr<gfxImageSurface> surf = new gfxImageSurface(data.get<PRUint8>(),
                                                          gfxIntSize(bufw, bufh),
                                                          4 * bufw,
                                                          gfxASurface::ImageFormatARGB32);
     nsRefPtr<gfxContext> ctx = new gfxContext(surf);
     ctx->SetMatrix(aMatrix);
 
-    PRBool oldDisableValue = nsLayoutUtils::sDisableGetUsedXAssertions;
-    nsLayoutUtils::sDisableGetUsedXAssertions = oldDisableValue || !flush;
     presShell->RenderDocument(r, flags, bgColor, ctx);
-    nsLayoutUtils::sDisableGetUsedXAssertions = oldDisableValue;
-
     return true;
 }
